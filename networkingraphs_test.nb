Notebook[{Cell[
BoxData[RowBox[{RowBox[{"(*"," ",RowBox[{"Define"," ","the"," ","adjacency"," ","matrix"}]," ","*)"}],"\n",RowBox[
{RowBox[{"adjMatrix"," ","="," ",RowBox[{"{","\n","    ",RowBox[{RowBox[{"{",RowBox[
{"0",","," ","1",","," ","1",","," ","0",","," ","0"}],"}"}],",","\n","    ",RowBox[
{"{",RowBox[{"1",","," ","0",","," ","1",","," ","1",","," ","0"}],"}"}],",","\n","    ",RowBox[
{"{",RowBox[{"1",","," ","1",","," ","0",","," ","0",","," ","1"}],"}"}],",","\n","    ",RowBox[
{"{",RowBox[{"0",","," ","1",","," ","0",","," ","0",","," ","1"}],"}"}],",","\n","    ",RowBox[
{"{",RowBox[{"0",","," ","0",","," ","1",","," ","1",","," ","0"}],"}"}]}],"\n","}"}]}],";"}]}]],
"Input",CellLabel -> "In[1]:= ",ExpressionUUID -> "5219ee24-db34-47c9-b595-5918955a32ca"],Cell[
BoxData[
RowBox[{RowBox[{"(*"," ",RowBox[{RowBox[{"Define"," ","the"," ","matrices"," ","for"," ","distance"}],","," ","load",","," ",RowBox[
{"and"," ","BeR"}]}]," ","*)"}],"\n",RowBox[{RowBox[{"distanceMatrix"," ","="," ",RowBox[
{"{","\n","    ",RowBox[{RowBox[{"{",RowBox[{"Infinity",","," ","18.796483",","," ","6.26380",","," ","Infinity",","," ","Infinity"}],"}"}],",","\n","    ",RowBox[
{"{",RowBox[{"18.79648",","," ","Infinity",","," ","3.61530",","," ","2.988675",","," ","Infinity"}],"}"}],",","\n","    ",RowBox[
{"{",RowBox[{"6.26380",","," ","3.615300",","," ","Infinity",","," ","Infinity",","," ","11.64145"}],"}"}],",","\n","    ",RowBox[
{"{",RowBox[{"Infinity",","," ","2.988675",","," ","Infinity",","," ","Infinity",","," ","14.27574"}],"}"}],",","\n","    ",RowBox[
{"{",RowBox[{"Infinity",","," ","Infinity",","," ","11.64145",","," ","14.275740",","," ","Infinity"}],"}"}]}],"\n","}"}]}],";"}]}]],
"Input",CellLabel -> "In[2]:= ",ExpressionUUID -> "f0f067f8-3475-4197-bf5b-44a9277ced2f"],Cell[
BoxData[
RowBox[{RowBox[{"loadMatrix"," ","="," ",RowBox[{"{","\n","    ",RowBox[{RowBox[{"{",RowBox[
{"Infinity",","," ","0.1386221",","," ","0.5984568",","," ","Infinity",","," ","Infinity"}],"}"}],",","\n","    ",RowBox[
{"{",RowBox[{"0.1386221",","," ","Infinity",","," ","0.5240758",","," ","0.8631663",","," ","Infinity"}],"}"}],",","\n","    ",RowBox[
{"{",RowBox[{"0.5984568",","," ","0.5240758",","," ","Infinity",","," ","Infinity",","," ","0.3763395"}],"}"}],",","\n","    ",RowBox[
{"{",RowBox[{"Infinity",","," ","0.8631663",","," ","Infinity",","," ","Infinity",","," ","0.3248558"}],"}"}],",","\n","    ",RowBox[
{"{",RowBox[{"Infinity",","," ","Infinity",","," ","0.3763395",","," ","0.3248558",","," ","Infinity"}],"}"}]}],"\n","}"}]}],";"}]],
"Input",CellLabel -> "In[3]:= ",ExpressionUUID -> "a29aa3ae-0127-40bd-9e45-ed7d15dfe02a"],Cell[
BoxData[
RowBox[{RowBox[{"berMatrix"," ","="," ",RowBox[{"{","\n","    ",RowBox[{RowBox[{"{",RowBox[
{"Infinity",","," ",RowBox[{"1","*",RowBox[{"10","^",RowBox[{"-","8"}]}]}],","," ",RowBox[
{"1","*",RowBox[{"10","^",RowBox[{"-","4"}]}]}],","," ","Infinity",","," ","Infinity"}],"}"}],",","\n","    ",RowBox[
{"{",RowBox[{RowBox[{"1","*",RowBox[{"10","^",RowBox[{"-","8"}]}]}],","," ","Infinity",","," ",RowBox[
{"1","*",RowBox[{"10","^",RowBox[{"-","6"}]}]}],","," ","0.001",","," ","Infinity"}],"}"}],",","\n","    ",RowBox[
{"{",RowBox[{RowBox[{"1","*",RowBox[{"10","^",RowBox[{"-","4"}]}]}],","," ",RowBox[
{"1","*",RowBox[{"10","^",RowBox[{"-","6"}]}]}],","," ","Infinity",","," ","Infinity",","," ","0.001"}],"}"}],",","\n","    ",RowBox[
{"{",RowBox[{"Infinity",","," ","0.001",","," ","Infinity",","," ","Infinity",","," ","0.001"}],"}"}],",","\n","    ",RowBox[
{"{",RowBox[{"Infinity",","," ","Infinity",","," ","0.001",","," ","0.001",","," ","Infinity"}],"}"}]}],"\n","}"}]}],";"}]],
"Input",CellLabel -> "In[4]:= ",ExpressionUUID -> "405e7803-876d-4b5a-b22d-70a52bcfb6ea"],Cell[
BoxData[
RowBox[{RowBox[{"(*"," ",RowBox[{"Define"," ","the"," ","cost"," ","function"}]," ","*)"}],"\n",RowBox[
{RowBox[{RowBox[{"calculateTotalCost","[",RowBox[{"distance_",","," ","load_",","," ","ber_"}],"]"}]," ",":="," ",RowBox[
{"Module","[",RowBox[{RowBox[{"{",RowBox[{"propagationDelay",","," ","transmissionQueueDelay",","," ","berPenalty"}],"}"}],",","\n","    ",RowBox[
{RowBox[{"propagationDelay"," ","="," ",RowBox[{"5"," ","*"," ","distance"}]}],";","\n","    ",RowBox[
{"transmissionQueueDelay"," ","="," ",RowBox[{"1"," ","/"," ",RowBox[{"(",RowBox[
{"1"," ","-"," ","load"}],")"}]}]}],";","\n","    ",RowBox[{"berPenalty"," ","="," ",RowBox[
{"Which","[","\n","        ",RowBox[{RowBox[{RowBox[{"ber"," ",">="," ",RowBox[{"10","^",RowBox[
{"-","4"}]}]}]," ","&&"," ",RowBox[{"ber"," ","<="," ","1"}]}],","," ","1000",",","\n","        ",RowBox[
{RowBox[{"ber"," ",">"," ",RowBox[{"10","^",RowBox[{"-","5"}]}]}]," ","&&"," ",RowBox[
{"ber"," ","<"," ",RowBox[{"10","^",RowBox[{"-","4"}]}]}]}],","," ","50",",","\n","        ","True",","," ","0"}],"\n","    ","]"}]}],";","\n","    ",RowBox[
{"propagationDelay"," ","+"," ","transmissionQueueDelay"," ","+"," ","berPenalty"}]}]}],"\n","]"}]}],";"}]}]],
"Input",CellLabel -> "In[5]:= ",ExpressionUUID -> "806da7d5-a878-453f-ba83-58d5aa4d6a2c"],Cell[
BoxData[
RowBox[{RowBox[{"(*"," ",RowBox[{"Apply"," ","the"," ","cost"," ","function"," ","to"," ","each"," ","valid"," ","link"}]," ","*)"}],"\n",RowBox[
{RowBox[{"costMatrix"," ","="," ",RowBox[{"MapThread","[","\n","    ",RowBox[{RowBox[
{RowBox[{"If","[",RowBox[{RowBox[{RowBox[{"#1"," ","!="," ","Infinity"}]," ","&&"," ",RowBox[
{"#2"," ","!="," ","Infinity"}]," ","&&"," ",RowBox[{"#3"," ","!="," ","Infinity"}]}],","," ",RowBox[
{"calculateTotalCost","[",RowBox[{"#1",","," ","#2",","," ","#3"}],"]"}],","," ","Infinity"}],"]"}]," ","&"}],",","\n","    ",RowBox[
{"{",RowBox[{"distanceMatrix",","," ","loadMatrix",","," ","berMatrix"}],"}"}],","," ","2"}],"\n","]"}]}],";"}]}]],
"Input",CellLabel -> "In[6]:= ",ExpressionUUID -> "b1245ae8-84b1-431d-885a-63b482eb2a36"],Cell[
BoxData[
RowBox[{RowBox[{"(*"," ",RowBox[{"Create"," ","the"," ","weighted"," ","graph"}]," ","*)"}],"\n",RowBox[
{RowBox[{"graph"," ","="," ",RowBox[{"WeightedAdjacencyGraph","[",RowBox[{"costMatrix",","," ",RowBox[
{"VertexLabels"," ","->"," ","\"Name\""}],","," ",RowBox[{"EdgeLabels"," ","->"," ","\"EdgeWeight\""}]}],"]"}]}],";"}]}]],
"Input",CellLabel -> "In[7]:= ",ExpressionUUID -> "894ef5bc-b7ce-4831-8852-44f2bb56b492"],Cell[
BoxData[
RowBox[{RowBox[{"(*"," ",RowBox[{"Find"," ","the"," ","shortest"," ","path"," ","from"," ","router"," ","2"," ","to"," ","router"," ","4"}]," ","*)"}],"\n",RowBox[
{RowBox[{"shortestPath"," ","="," ",RowBox[{"FindShortestPath","[",RowBox[{"graph",","," ","2",","," ","4"}],"]"}]}],";"}]}]],
"Input",CellLabel -> "In[8]:= ",ExpressionUUID -> "5f0b1e54-bd06-4266-81b5-aa7901462f39"],Cell[
CellGroupData[
{Cell[
BoxData["shortestPath"],"Input",CellLabel -> "In[9]:= ",ExpressionUUID -> "e8c4555b-fd3c-45d7-9e69-41e6be216d84"],Cell[
BoxData[
RowBox[{"{",RowBox[{"2",",","4"}],"}"}],StandardForm],"Output",CellLabel -> "Out[9]= ",
ExpressionUUID -> "773497e8-092b-47d3-939c-28dd71dd9b23"]},Open],ExpressionUUID -> "745ce2fd-ca80-489d-bee9-07c5c3742b84"]},
StyleDefinitions -> "Default.nb",FrontEndVersion -> "14. for Wolfram Cloud 1.67.1 (December 19, 2023)"]